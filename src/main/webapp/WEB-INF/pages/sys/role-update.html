<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>修改角色</title>
    <link href="../../../css/tail.css" rel="stylesheet" type="text/css">
    <link href="../../../plugin/bstable/css/bootstrap.min.css" rel="stylesheet" type="text/css">
</head>
<body style="border-radius: 8px;">
<form id="roleForm" target="submitFrame">
    <input type="hidden" name="roleId" th:value="${role.roleId}">
    <div class="top table2_top">
        <div>
            <div class="top_out" style="margin-top: 10px">
                <table class="table">
                    <tbody>
                    <tr>
                        <td>角色名称<span></span></td>
                        <td>
                            <input type="text" class="long_text" name="roleName" th:value="${role.roleName}">
                        </td>
                    </tr>
                    <tr>
                        <td>角色描述<span></span></td>
                        <td style="text-align: left">
                            <textarea style="width: 358px;" name="decription" th:text="${role.decription}"></textarea>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="notice_bot">
            <div class="l_left"><input type="checkbox" checked="checked"/>保存并关闭窗口</div>
            <div class="r_right but_p">
                <button class="but_save" type="button">保存</button>
                <button class="but_close">关闭</button>
            </div>
        </div>
    </div>
</form>
<iframe id="submitFrame" style="display: none;width:0; height:0" name="submitFrame"  src="about:blank"></iframe>
<script src="../../../js/jquery-2.2.0.min.js"></script>
<script src="../../../plugin/layer_v2.1/layer/layer.js"></script>
<script>
    $(function () {
        //保存
        $(".but_save").on("click",function () {
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "/sys/role/addOrUpdate.shtm",
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                data: $("#roleForm").serialize(),
                success: function (result) {
                    parent.layer.msg(result.msg);
                    if(result.code == 200){
                        $("input[name='roleId']").val(result.role.roleId);
                        parent.$("#table").bootstrapTable('refresh');
                        if($(".notice_bot").find("input[type='checkbox']")[0].checked){
                            $(".but_close").click();
                        }
                    }
                }
            });
        });
        //关闭按钮
        $(".but_close").on("click",function () {
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
        });
    });
</script>
</body>
</html>
