<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <head>
        <link href="../../../css/tree.css" rel="stylesheet" type="text/css">
    </head>
<body>
    <form id="categoryForm" target="submitFrame">
        <input type="hidden" name="categoryCode" th:value="${category.categoryCode}">
        <div class="div_form">
            <div>
                <label class="form_label">商品类别名称<span>*</span></label>
                <input type="text" class="form_input" name="categoryName" th:value="${category.categoryName}">
            </div>
        </div>
        <div style="clear: both"></div>
        <div class="notice_bot">
            <div class="l_left"><input type="checkbox" checked="checked"/>保存并关闭窗口</div>
            <div class="r_right but_p">
                <button class="but_save">保存</button>
                <button class="but_close">关闭</button>
            </div>
        </div>
    </form>
    <iframe id="submitFrame" style="display: none;width:0; height:0" name="submitFrame"  src="about:blank"></iframe>
</body>

<script src="../../../js/jquery-2.2.0.min.js"></script>
<script src="../../../plugin/layer_v2.1/layer/layer.js"></script>
<script>
    $(function () {
        //保存
        $(".but_save").on("click",function () {
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "/dic/category/addOrUpdate.shtm",
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                data: $("#categoryForm").serialize(),
                success: function (result) {
                    parent.layer.msg(result.msg);
                    if(result.code==200){
                        $("input[name='categoryCode']").val(result.category.categoryCode);
                        parent.$("#table").bootstrapTable('refresh');
                        if($(".notice_bot").find("input[type='checkbox']")[0].checked){
                            $(".but_close").click();
                        }
                    }
                }
            });
        });
        //关闭按钮
        $(".but_close").on("click",function () {
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
        });
    });
</script>
</html>
